{"version":3,"file":"component---src-pages-node-calc-tsx-d8455da9897734327718.js","mappings":"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","sources":["webpack://tpcstld-site/./src/pages/node-calc.tsx"],"sourcesContent":["import {ChangeEvent, useCallback, useState} from 'react';\nimport {Helmet} from 'react-helmet';\n\ntype NodeType = [string, string, string];\ntype Histogram = Record<string, number>;\ntype SkillsList = Set<string>;\n\nfunction getStarter(skillsList: SkillsList): Histogram {\n  return Object.assign(\n    {},\n    ...[...skillsList.keys()].map((skill) => ({[skill]: 0})),\n  );\n}\n\nfunction getHistogram(\n  skillsList: SkillsList,\n  nodes: Array<NodeType>,\n): Record<string, number> {\n  const answer = getStarter(skillsList);\n\n  for (const node of nodes) {\n    for (const skill of node) {\n      answer[skill] = answer[skill] + 1;\n    }\n  }\n\n  return answer;\n}\n\nfunction nodesMet(histogram: Histogram): number {\n  let answer = 0;\n  for (const key in histogram) {\n    answer = answer + histogram[key];\n  }\n\n  return answer;\n}\n\ntype Result = [Array<NodeType>, Histogram];\n\nfunction calculateBestNodes(\n  skillsList: SkillsList,\n  availableNodes: Array<NodeType>,\n  usedNodes: Array<NodeType>,\n): Result | null {\n  const answer = [...usedNodes];\n  const histogram = getHistogram(skillsList, answer);\n\n  const firstNodes = new Set<string>();\n  for (const node of usedNodes) {\n    if (firstNodes.has(node[0])) {\n      return null;\n    }\n\n    firstNodes.add(node[0]);\n  }\n\n  if (availableNodes.length === 0) {\n    return [answer, histogram];\n  }\n\n  for (const key in histogram) {\n    if (histogram[key] > 2) {\n      return null;\n    }\n  }\n\n  if (nodesMet(histogram) === 18) {\n    return [answer, histogram];\n  }\n\n  let bestNumNodes: number = answer.length;\n  let bestResult: Result = [answer, histogram];\n\n  for (const node of availableNodes) {\n    const attempt = [...answer, node];\n    const newAvailable = [...availableNodes].filter((n) => n !== node);\n\n    const result = calculateBestNodes(skillsList, newAvailable, attempt);\n    if (result == null) {\n      continue;\n    }\n    const [, resultHistogram] = result;\n    const numNodes = nodesMet(resultHistogram);\n\n    if (numNodes > bestNumNodes) {\n      bestNumNodes = numNodes;\n      bestResult = result;\n    }\n  }\n\n  return bestResult;\n}\n\ninterface UserInput {\n  nodes: Array<NodeType>;\n  skills: SkillsList;\n}\n\nfunction parseInput(input: string): UserInput {\n  const lines = input.split('\\n');\n\n  const nodes: Array<NodeType> = [];\n  const skills = new Set<string>();\n\n  for (const line of lines) {\n    if (line === '' || line.startsWith('#')) {\n      continue;\n    }\n\n    const n = line.split(' ');\n    if (n.length !== 3) {\n      throw new Error('Bad Parsing');\n    }\n\n    for (const skill of n) {\n      skills.add(skill);\n    }\n\n    nodes.push(n as [string, string, string]);\n  }\n\n  return {\n    nodes,\n    skills,\n  };\n}\n\nfunction ResultView({result}: {result: Result | null}) {\n  if (result == null) {\n    return null;\n  }\n\n  const [nodes, histogram] = result;\n\n  return (\n    <div style={{marginTop: '32px'}}>\n      <span>Nodes:</span>\n      <ul>\n        {nodes.map((node, i) => (\n          <li key={i}>{JSON.stringify(node)}</li>\n        ))}\n      </ul>\n      <span>Allocation:</span>\n      <table style={{marginLeft: '32px'}}>\n        {Object.entries(histogram).map(([node, num]) => (\n          <tr key={node}>\n            <td>{node}</td>\n            <td>{num}</td>\n          </tr>\n        ))}\n      </table>\n    </div>\n  );\n}\n\nexport default function NodeCalcPage() {\n  const [result, setResult] = useState<[Array<NodeType>, Histogram] | null>(\n    null,\n  );\n  const [working, setWorking] = useState(false);\n  const [input, setInput] = useState('');\n  const [error, setError] = useState<string | null>(null);\n\n  const handleChangeInput = useCallback(\n    (event: ChangeEvent<HTMLTextAreaElement>) => {\n      setInput(event.target.value);\n    },\n    [],\n  );\n\n  function test() {\n    setWorking(true);\n    setTimeout(() => {\n      try {\n        const userInput = parseInput(input);\n        setResult(calculateBestNodes(userInput.skills, userInput.nodes, []));\n        setError(null);\n      } catch (e: unknown) {\n        if (e instanceof Error) {\n          setError(e.message);\n        } else {\n          setError('Unknown error');\n        }\n      }\n      setWorking(false);\n    }, 0);\n  }\n\n  return (\n    <div>\n      <Helmet htmlAttributes={{lang: 'en'}}>\n        <title>Maplestory TriNode Solver</title>\n        <meta name=\"description\" content=\"Thinking is too hard.\" />\n      </Helmet>\n      <div>Instructions:</div>\n      <ol>\n        <li>Figure out what your perfect tri skills are.</li>\n        <li>Make up some stable shorthand names for each skill.</li>\n        <li>Write down each nodestone using your shorthands with 3 perfect tri skills. Space between each skill. Newline between each node.</li>\n        <li>Solve!</li>\n      </ol>\n      <div>\n        <textarea\n          value={input}\n          onChange={handleChangeInput}\n          placeholder={'SkillA SkillB SkillC\\nSkillD SkillE SkillF'}\n        />\n        <br />\n        <button onClick={test} disabled={working}>\n          {working ? 'Solving...' : 'Solve'}\n        </button>\n        {error != null ? <span>{error}</span> : null}\n        <ResultView result={result} />\n      </div>\n    </div>\n  );\n}\n"],"names":["getHistogram","skillsList","nodes","answer","Object","assign","keys","map","skill","getStarter","nodesMet","histogram","key","calculateBestNodes","availableNodes","usedNodes","firstNodes","Set","node","has","add","length","bestNumNodes","bestResult","attempt","newAvailable","filter","n","result","numNodes","ResultView","_jsxs","style","marginTop","children","_jsx","i","JSON","stringify","marginLeft","entries","num","NodeCalcPage","useState","setResult","working","setWorking","input","setInput","error","setError","handleChangeInput","useCallback","event","target","value","Helmet","htmlAttributes","lang","name","content","onChange","placeholder","onClick","setTimeout","userInput","lines","split","skills","line","startsWith","Error","push","parseInput","e","message","disabled"],"sourceRoot":""}