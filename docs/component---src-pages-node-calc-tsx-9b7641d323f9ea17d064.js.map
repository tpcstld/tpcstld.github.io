{"version":3,"file":"component---src-pages-node-calc-tsx-9b7641d323f9ea17d064.js","mappings":"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","sources":["webpack://tpcstld-site/./src/pages/node-calc.tsx"],"sourcesContent":["import {ChangeEvent, useCallback, useState} from 'react';\nimport {Helmet} from 'react-helmet';\n\ntype NodeType = [string, string, string];\ntype Histogram = Record<string, number>;\ntype SkillsList = Set<string>;\n\nfunction getStarter(skillsList: SkillsList): Histogram {\n  return Object.assign(\n    {},\n    ...[...skillsList.keys()].map((skill) => ({[skill]: 0})),\n  );\n}\n\nfunction getHistogram(\n  skillsList: SkillsList,\n  nodes: Array<NodeType>,\n): Record<string, number> {\n  const answer = getStarter(skillsList);\n\n  for (const node of nodes) {\n    for (const skill of node) {\n      answer[skill] = answer[skill] + 1;\n    }\n  }\n\n  return answer;\n}\n\nfunction nodesMet(histogram: Histogram): number {\n  let answer = 0;\n  for (const key in histogram) {\n    answer = answer + histogram[key];\n  }\n\n  return answer;\n}\n\ntype Result = [Array<NodeType>, Histogram];\n\nfunction calculateBestNodes(\n  skillsList: SkillsList,\n  availableNodes: Array<NodeType>,\n  usedNodes: Array<NodeType>,\n): Result | null {\n  const answer = [...usedNodes];\n  const histogram = getHistogram(skillsList, answer);\n\n  const firstNodes = new Set<string>();\n  for (const node of usedNodes) {\n    if (firstNodes.has(node[0])) {\n      return null;\n    }\n\n    firstNodes.add(node[0]);\n  }\n\n  if (availableNodes.length === 0) {\n    return [answer, histogram];\n  }\n\n  for (const key in histogram) {\n    if (histogram[key] > 2) {\n      return null;\n    }\n  }\n\n  if (nodesMet(histogram) === 18) {\n    return [answer, histogram];\n  }\n\n  let bestNumNodes: number = answer.length;\n  let bestResult: Result = [answer, histogram];\n\n  for (const node of availableNodes) {\n    const attempt = [...answer, node];\n    const newAvailable = [...availableNodes].filter((n) => n !== node);\n\n    const result = calculateBestNodes(skillsList, newAvailable, attempt);\n    if (result == null) {\n      continue;\n    }\n    const [, resultHistogram] = result;\n    const numNodes = nodesMet(resultHistogram);\n\n    if (numNodes > bestNumNodes) {\n      bestNumNodes = numNodes;\n      bestResult = result;\n    }\n  }\n\n  return bestResult;\n}\n\ninterface UserInput {\n  nodes: Array<NodeType>;\n  skills: SkillsList;\n}\n\nfunction parseInput(input: string): UserInput {\n  const lines = input.split('\\n');\n\n  const nodes: Array<NodeType> = [];\n  const skills = new Set<string>();\n\n  for (const line of lines) {\n    if (line === '' || line.startsWith('#')) {\n      continue;\n    }\n\n    const n = line.split(' ');\n    if (n.length !== 3) {\n      throw new Error('Bad Parsing');\n    }\n\n    for (const skill of n) {\n      skills.add(skill);\n    }\n\n    nodes.push(n as [string, string, string]);\n  }\n\n  return {\n    nodes,\n    skills,\n  };\n}\n\nfunction ResultView({result}: {result: Result | null}) {\n  if (result == null) {\n    return null;\n  }\n\n  const [nodes, histogram] = result;\n\n  return (\n    <div style={{marginTop: '32px'}}>\n      <span>Nodes:</span>\n      <ul>\n        {nodes.map((node, i) => (\n          <li key={i}>{JSON.stringify(node)}</li>\n        ))}\n      </ul>\n      <span>Allocation:</span>\n      <table style={{marginLeft: '32px'}}>\n        {Object.entries(histogram).map(([node, num]) => (\n          <tr key={node}>\n            <td>{node}</td>\n            <td>{num}</td>\n          </tr>\n        ))}\n      </table>\n    </div>\n  );\n}\n\nexport default function NodeCalcPage() {\n  const [result, setResult] = useState<[Array<NodeType>, Histogram] | null>(\n    null,\n  );\n  const [working, setWorking] = useState(false);\n  const [input, setInput] = useState('');\n  const [error, setError] = useState<string | null>(null);\n\n  const handleChangeInput = useCallback(\n    (event: ChangeEvent<HTMLTextAreaElement>) => {\n      setInput(event.target.value);\n    },\n    [],\n  );\n\n  function test() {\n    setWorking(true);\n    setTimeout(() => {\n      try {\n        const userInput = parseInput(input);\n        setResult(calculateBestNodes(userInput.skills, userInput.nodes, []));\n        setError(null);\n      } catch (e: unknown) {\n        if (e instanceof Error) {\n          setError(e.message);\n        } else {\n          setError('Unknown error');\n        }\n      }\n      setWorking(false);\n    }, 0);\n  }\n\n  return (\n    <div>\n      <Helmet htmlAttributes={{lang: 'en'}}>\n        <title>Maplestory TriNode Solver</title>\n        <meta name=\"description\" content=\"Thinking is too hard.\" />\n      </Helmet>\n      <div>Instructions:</div>\n      <ol>\n        <li>Figure out what your perfect tri skills are.</li>\n        <li>Make up some stable shorthand names for each skill.</li>\n        <li>Write down each nodestone using your shorthands with 3 perfect tri skills. Space between each skill. Newline between each node.</li>\n        <li>Solve!</li>\n      </ol>\n      <div>\n        <textarea\n          value={input}\n          onChange={handleChangeInput}\n          placeholder={'SkillA SkillB SkillC\\nSkillD SkillE SkillF'}\n        />\n        <br />\n        <button onClick={test} disabled={working}>\n          {working ? 'Solving...' : 'Solve'}\n        </button>\n        {error != null ? <span>{error}</span> : null}\n        <ResultView result={result} />\n      </div>\n    </div>\n  );\n}\n"],"names":["getHistogram","skillsList","nodes","answer","Object","assign","keys","map","skill","getStarter","nodesMet","histogram","key","calculateBestNodes","availableNodes","usedNodes","firstNodes","Set","node","has","add","length","bestNumNodes","bestResult","attempt","newAvailable","filter","n","result","numNodes","ResultView","_jsxs","style","marginTop","children","_jsx","i","JSON","stringify","marginLeft","entries","num","NodeCalcPage","useState","setResult","working","setWorking","input","setInput","error","setError","handleChangeInput","useCallback","event","target","value","Helmet","htmlAttributes","lang","name","content","onChange","placeholder","onClick","setTimeout","userInput","lines","split","skills","line","startsWith","Error","push","parseInput","e","message","disabled"],"sourceRoot":""}